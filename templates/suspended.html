<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© - Ø³Ø¨ÙˆÙ†Ø¬ Ø¥ÙŠ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="/static/favicon.png">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css"/>
    <style>
        :root {
            /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø­Ø§Ù„Ø§Øª */
            --color-accounted: #87CEEB; /* ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© - Ø§Ø²Ø±Ù‚ ÙØ§ØªØ­ */
            --color-mandob-accounted: #191970; /* ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ - Ù†ÙŠÙ„ÙŠ ØºØ§Ù…Ù‚ */
            --color-customer-accounted: #6495ED; /* ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ - Ù†ÙŠÙ„ÙŠ ÙØ§ØªØ­ */
            --color-delivered: #28a745; /* ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… - Ø§Ø®Ø¶Ø± */
            --color-rejected: #B22222; /* Ø±ÙØ¶ - Ø§Ø­Ù…Ø± ØºØ§Ù…Ù‚ Ù‚Ù„ÙŠÙ„Ø§ */
            --color-partial-return: #FFB6C1; /* Ø±Ø§Ø¬Ø¹ Ø¬Ø²Ø¦ÙŠ - Ø§Ø­Ù…Ø± ÙØ§ØªØ­ */
            --color-delayed: #FFA500; /* Ù…Ø¤Ø¬Ù„ - Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ */
            --color-in-progress: #FFD700; /* Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ° - Ø§ØµÙØ± */
            --color-unconfirmed: #708090; /* ØºÙŠØ± Ù…Ø¤ÙƒØ¯ - Ø±ØµØ§ØµÙŠ */
            --color-partial-return-yellow: #FF6347; /* Ø±Ø§Ø¬Ø¹ Ø¬Ø²Ø¦ÙŠ - Ø§Ø­Ù…Ø± Ù…Ø¹ Ø§ØµÙØ±Ø§Ø± */
            --color-partial-delivered: #006400; /* ÙˆØ§ØµÙ„ Ø¬Ø²Ø¦ÙŠ - Ø§Ø®Ø¶Ø± ØºØ§Ù…Ù‚ */
            
            /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ø§Ù… */
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255,255,255,0.95);
            --glass-effect: rgba(255,255,255,0.1);
        }
        
        body {
            background: var(--primary-gradient);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø© */
        @media (max-width: 768px) {
            body {
                font-size: 12px;
            }
            
            .container-fluid {
                padding: 10px;
            }
            
            .card-body {
                padding: 15px;
            }
            
            .table-responsive {
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            }
            
            .btn-sm {
                padding: 4px 8px;
                font-size: 11px;
            }
            
            .badge {
                font-size: 0.7em;
                padding: 4px 8px;
            }
            
            .suspension-reason {
                font-size: 0.7em;
            }
            
            .btn-group-vertical .btn {
                font-size: 10px;
                padding: 2px 5px;
            }
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø­Ø¯ÙŠØ« */
        .card {
            border: none;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            backdrop-filter: blur(15px);
            background: var(--card-bg);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ù…Ø­Ø³Ù† */
        .navbar {
            background: var(--card-bg) !important;
            backdrop-filter: blur(15px);
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .nav-link {
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 10px;
            margin: 0 5px;
        }
        
        .nav-link:hover, .nav-link.active {
            background: var(--glass-effect);
            transform: translateY(-2px);
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­Ø³Ù† */
        .table {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
        }
        
        .table thead th {
            background: var(--primary-gradient);
            color: white;
            font-weight: 600;
            border: none;
            padding: 15px 10px;
        }
        
        .table tbody tr {
            transition: all 0.3s ease;
        }
        
        .table tbody tr:hover {
            background: var(--glass-effect);
            transform: scale(1.01);
        }
        
        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø­Ø§Ù„Ø§Øª */
        .status-accounted { background: var(--color-accounted) !important; color: #000 !important; }
        .status-mandob-accounted { background: var(--color-mandob-accounted) !important; color: #fff !important; }
        .status-customer-accounted { background: var(--color-customer-accounted) !important; color: #fff !important; }
        .status-delivered { background: var(--color-delivered) !important; color: #fff !important; }
        .status-rejected { background: var(--color-rejected) !important; color: #fff !important; }
        .status-partial-return { background: var(--color-partial-return) !important; color: #000 !important; }
        .status-delayed { background: var(--color-delayed) !important; color: #000 !important; }
        .status-in-progress { background: var(--color-in-progress) !important; color: #000 !important; }
        .status-unconfirmed { background: var(--color-unconfirmed) !important; color: #fff !important; }
        .status-partial-return-yellow { background: var(--color-partial-return-yellow) !important; color: #fff !important; }
        .status-partial-delivered { background: var(--color-partial-delivered) !important; color: #fff !important; }
        .status-warehouse-return { background: #8A2BE2 !important; color: #fff !important; }
        
        .badge {
            font-size: 0.8em;
            padding: 8px 12px;
            border-radius: 25px;
            font-weight: 600;
            text-transform: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn {
            border-radius: 15px;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ÙÙ„Ø§ØªØ± */
        .form-control, .form-select {
            border-radius: 15px;
            border: 2px solid var(--glass-effect);
            background: var(--card-bg);
            transition: all 0.3s ease;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª */
        .alert {
            border-radius: 15px;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .alert-warning {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù…Ø¨Ø§Ù„Øº */
        .amount-display {
            font-weight: 700;
            color: #28a745;
            font-family: 'Courier New', monospace;
        }
        
        /* Ø³Ø¨Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ */
        .suspension-reason {
            font-size: 0.9em;
            color: #dc3545;
            font-weight: 600;
            background: rgba(220, 53, 69, 0.1);
            padding: 5px 10px;
            border-radius: 10px;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª */
        .fas, .far {
            transition: all 0.3s ease;
        }
        
        .btn:hover .fas, .btn:hover .far {
            transform: scale(1.1);
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª DataTables Ù„Ù„Ù‡ÙˆØ§ØªÙ */
        @media (max-width: 768px) {
            .dataTables_wrapper .dataTables_length,
            .dataTables_wrapper .dataTables_filter {
                text-align: center;
                margin-bottom: 10px;
            }
            
            .dataTables_wrapper .dataTables_info,
            .dataTables_wrapper .dataTables_paginate {
                text-align: center;
                margin-top: 10px;
            }
            
            .dataTables_wrapper .dataTables_paginate .paginate_button {
                padding: 5px 10px;
                margin: 2px;
                border-radius: 10px;
            }
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© */
        .filter-section {
            background: var(--glass-effect);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
        }
        
        .form-check-input:checked {
            background-color: #667eea;
            border-color: #667eea;
        }
    </style>
</head>
<body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ù…Ø­Ø³Ù† -->
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/">
                <i class="fas fa-eye me-2"></i>
                Ø³Ø¨ÙˆÙ†Ø¬ Ø¥ÙŠ
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/"><i class="fas fa-home me-1"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a class="nav-link" href="/today_orders"><i class="fas fa-calendar-day me-1"></i> Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…</a>
                <a class="nav-link" href="/customers"><i class="fas fa-users me-1"></i> Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</a>
                <a class="nav-link" href="/agent_commission"><i class="fas fa-money-bill-wave me-1"></i> Ø­Ø³Ø§Ø¨ Ù…Ø³ØªØ­Ù‚</a>
                <a class="nav-link" href="/isolated"><i class="fas fa-exclamation-triangle me-1"></i> Ø§Ù„Ù…Ø¹Ø²ÙˆÙ„Ø©</a>
                <a class="nav-link active" href="/suspended"><i class="fas fa-clock me-1"></i> Ø§Ù„Ù…Ø¹Ù„Ù‚Ø§Øª</a>
                <a class="nav-link" href="/processed_orders"><i class="fas fa-check-circle me-1"></i> Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</a>
                <a class="nav-link" href="/monitoring"><i class="fas fa-history me-1"></i> Ø§Ù„Ø³Ø¬Ù„</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="alert alert-warning slide-in">
            <h5><i class="fas fa-clock me-2"></i>ØªÙ†Ø¨ÙŠÙ‡!</h5>
            <p class="mb-0">Ù‡Ø°Ù‡ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…ØªØ§Ø¨Ø¹Ø© ÙÙˆØ±ÙŠØ© Ø¨Ø³Ø¨Ø¨ Ù…Ø±ÙˆØ± ÙˆÙ‚Øª Ø·ÙˆÙŠÙ„ Ø¹Ù„ÙŠÙ‡Ø§.</p>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-4 slide-in">
            <h2><i class="fas fa-clock me-2"></i>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h2>
            <div class="d-flex flex-wrap gap-2">
                <a href="/print_suspended_report" class="btn btn-primary btn-lg" target="_blank">
                    <i class="fas fa-print me-2"></i>
                    Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                </a>
                <a href="/suspended" class="btn btn-warning btn-lg">
                    <i class="fas fa-clock me-2"></i>
                    ÙƒØ´Ù Ø§Ù„Ù…Ø¹Ù„Ù‚Ø§Øª
                </a>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø­Ø³Ù† -->
        <div class="card mb-4 slide-in">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-filter me-2"></i>
                    ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
                </h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label">Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù†Øµ:</label>
                        <input type="text" class="form-control" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø£ÙŠ Ø­Ù‚Ù„...">
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label text-success fw-bold">
                            <i class="fas fa-check-circle me-1"></i>
                            ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª:
                        </label>
                        <div class="filter-section">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="statusInProgress" value="Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°">
                            <label class="form-check-label" for="statusInProgress">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="statusDelayed" value="Ù…Ø¤Ø¬Ù„">
                            <label class="form-check-label" for="statusDelayed">Ù…Ø¤Ø¬Ù„</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="statusRejected" value="Ø±ÙØ¶">
                            <label class="form-check-label" for="statusRejected">Ø±ÙØ¶</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="statusReturned" value="Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†">
                            <label class="form-check-label" for="statusReturned">Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†</label>
                        </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="statusDelivered" value="ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…">
                                <label class="form-check-label" for="statusDelivered">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="statusMandobAccounted" value="ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨">
                                <label class="form-check-label" for="statusMandobAccounted">ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</label>
                            </div>
                        <div class="mt-2">
                            <button type="button" class="btn btn-success btn-sm me-1" onclick="selectAllStatuses()">
                                <i class="fas fa-check-double me-1"></i> ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„
                            </button>
                            <button type="button" class="btn btn-outline-success btn-sm" onclick="clearAllStatuses()">
                                <i class="fas fa-times me-1"></i> Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                            </button>
                        </div>
                    </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label text-danger fw-bold">
                            <i class="fas fa-times-circle me-1"></i>
                            Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª:
                        </label>
                        <div class="filter-section">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="excludeInProgress" value="Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°">
                            <label class="form-check-label" for="excludeInProgress">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="excludeDelayed" value="Ù…Ø¤Ø¬Ù„">
                            <label class="form-check-label" for="excludeDelayed">Ù…Ø¤Ø¬Ù„</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="excludeRejected" value="Ø±ÙØ¶">
                            <label class="form-check-label" for="excludeRejected">Ø±ÙØ¶</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="excludeReturned" value="Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†">
                            <label class="form-check-label" for="excludeReturned">Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†</label>
                        </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="excludeDelivered" value="ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…">
                                <label class="form-check-label" for="excludeDelivered">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="excludeMandobAccounted" value="ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨">
                                <label class="form-check-label" for="excludeMandobAccounted">ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</label>
                            </div>
                        <div class="mt-2">
                            <button type="button" class="btn btn-danger btn-sm me-1" onclick="selectAllExclusions()">
                                <i class="fas fa-times-circle me-1"></i> Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„ÙƒÙ„
                            </button>
                            <button type="button" class="btn btn-outline-danger btn-sm" onclick="clearAllExclusions()">
                                <i class="fas fa-times me-1"></i> Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                            </button>
                        </div>
                    </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label">
                            <i class="fas fa-exclamation-triangle me-1"></i>
                            Ø³Ø¨Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚:
                        </label>
                        <select class="form-select" id="suspensionFilter">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨</option>
                            {% set suspension_reasons = orders | map(attribute='suspension_reason') | list | unique | sort %}
                            {% for reason in suspension_reasons %}
                                {% if reason %}
                                    <option value="{{ reason }}">{{ reason }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                        </div>
                            </div>
                <div class="row">
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº:</label>
                        <select class="form-select" id="amountFilter">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¨Ø§Ù„Øº</option>
                            <option value="0-10000">Ø£Ù‚Ù„ Ù…Ù† 10,000</option>
                            <option value="10000-50000">10,000 - 50,000</option>
                            <option value="50000-100000">50,000 - 100,000</option>
                            <option value="100000+">Ø£ÙƒØ«Ø± Ù…Ù† 100,000</option>
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label">
                            <i class="fas fa-user me-1"></i>
                            Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨:
                        </label>
                        <select class="form-select" id="mandobFilter">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</option>
                            {% set mandobs = orders | map(attribute='mandob_name') | list | unique | sort %}
                            {% for mandob in mandobs %}
                                {% if mandob %}
                                    <option value="{{ mandob }}">{{ mandob }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                        </div>
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label">
                            <i class="fas fa-users me-1"></i>
                            Ø§Ù„Ø¹Ù…ÙŠÙ„:
                        </label>
                        <select class="form-select" id="customerFilter">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</option>
                            {% set customers = orders | map(attribute='customer_name') | list | unique | sort %}
                            {% for customer in customers %}
                                {% if customer %}
                                    <option value="{{ customer }}">{{ customer }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                        </div>
                    <div class="col-lg-3 col-md-6 col-sm-12 mb-3">
                        <label class="form-label">
                            <i class="fas fa-map-marker-alt me-1"></i>
                            Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:
                        </label>
                        <select class="form-select" id="cityFilter">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯Ù†</option>
                            {% set cities = orders | map(attribute='city') | list | unique | sort %}
                            {% for city in cities %}
                                {% if city %}
                                    <option value="{{ city }}">{{ city }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-12">
                        <div class="d-flex flex-wrap gap-2">
                        <button class="btn btn-secondary" onclick="clearFilters()">
                            <i class="fas fa-times me-1"></i>
                            Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±
                        </button>
                        <button class="btn btn-info" onclick="exportFilteredData()">
                            <i class="fas fa-download me-1"></i>
                            ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
                        </button>
                        <a href="/print_suspended_report" class="btn btn-primary" target="_blank">
                            <i class="fas fa-print me-1"></i>
                            Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                        </a>
                        <button class="btn btn-success" onclick="printFilteredData()">
                            <i class="fas fa-print me-1"></i>
                            Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
                        </button>
                        <button class="btn btn-warning" onclick="showFilterStats()">
                            <i class="fas fa-chart-bar me-1"></i>
                            Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙ„ØªØ±Ø©
                        </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© -->
        <div class="card slide-in">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-clock me-2"></i>
                    Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© - {{ orders|length }} Ø·Ù„Ø¨
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover w-100" id="suspendedTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„</th>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø³Ø¨Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th>
                                <th>Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in orders %}
                            <tr>
                                <td><strong>{{ loop.index }}</strong></td>
                                <td>{{ order.wasl_number }}</td>
                                <td>{{ order.order_number }}</td>
                                <td>{{ order.customer_name }}</td>
                                <td class="amount-display">{{ format_iraqi_dinar(order.total_amount) }}</td>
                                <td>
                                    <span class="badge" data-status="{{ order.status }}">
                                        {{ order.status }}
                                    </span>
                                </td>
                                <td>
                                    <span class="suspension-reason">
                                        <i class="fas fa-exclamation-triangle me-1"></i>
                                        {{ order.suspension_reason }}
                                    </span>
                                </td>
                                <td>{{ order.add_date }}</td>
                                <td>{{ order.city }}</td>
                                <td>
                                    <span class="badge bg-secondary">
                                        <i class="fas fa-user me-1"></i>
                                        {{ order.mandob_name or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}
                                    </span>
                                </td>
                                <td>
                                    <button class="btn btn-info btn-sm me-1" 
                                            title="Ù†Ø³Ø® Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨"
                                            onclick="copyOrderInfo(event, '{{ order.wasl_number }}', '{{ order.customer_name }}', '{{ format_iraqi_dinar(order.total_amount) }}', '{{ order.status }}', '{{ order.customer_phone }}', '{{ order.city }}', '{{ order.area }}', '{{ order.mandob_name }}')">
                                        <i class="fas fa-copy me-1"></i> Ù†Ø³Ø®
                                    </button>
                                    <a class="btn btn-secondary btn-sm me-1" 
                                       title="Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙˆØµÙ„"
                                       href="https://alkarar-exp.com/print_waslAll.php?wasl_id={{ order.order_number }}" 
                                       target="_blank">
                                        <i class="fas fa-print me-1"></i> Ø·Ø¨Ø§Ø¹Ø©
                                    </a>
                                    {% if order.status.strip() in ['Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†', 'Ø±ÙØ¶'] %}
                                    <a href="/delete_order/{{ order.wasl_number }}" 
                                       class="btn btn-danger btn-sm" 
                                       title="Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ"
                                       onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ø±Ù‚Ù… {{ order.wasl_number }}ØŸ')">
                                        <i class="fas fa-trash me-1"></i> Ø­Ø°Ù
                                    </a>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <!-- ØªÙØ¹ÙŠÙ„ DataTables -->
    <script>
    $(document).ready(function() {
        // ØªÙØ¹ÙŠÙ„ DataTables Ù…Ø¹ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø­Ø³Ù†Ø©
        var table = $('#suspendedTable').DataTable({
            "paging": true,
            "lengthMenu": [10, 20, 30, 40, 50, 60, 70, 100],
            "pageLength": 20,
            "language": {
                "url": "//cdn.datatables.net/plug-ins/1.13.6/i18n/ar.json"
            },
            "ordering": true,
            "info": true,
            "searching": true,
            "responsive": true,
            "autoWidth": false,
            "columnDefs": [
                { "width": "5%", "targets": 0 },
                { "width": "10%", "targets": [1, 2] },
                { "width": "12%", "targets": 3 },
                { "width": "10%", "targets": 4 },
                { "width": "8%", "targets": 5 },
                { "width": "15%", "targets": 6 },
                { "width": "8%", "targets": [7, 8] },
                { "width": "10%", "targets": 9 },
                { "width": "12%", "targets": 10 }
            ],
            "drawCallback": function(settings) {
                // ØªØ·Ø¨ÙŠÙ‚ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØµØµ
                applyCustomStatusColors();
            }
        });
        
        // Ø±Ø¨Ø· Ø§Ù„ÙÙ„Ø§ØªØ± Ø¨Ù€ DataTable
        setupFilters(table);
        
        // ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ©
        $('.slide-in').each(function(index) {
            $(this).delay(index * 100).queue(function(next) {
                $(this).addClass('slide-in');
                next();
            });
        });
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØµØµØ© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        applyCustomStatusColors();
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        setTimeout(function() { updateFilterCounter(table); }, 500);
    });
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙÙ„Ø§ØªØ±
    function setupFilters(table) {
        // ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù†ØµÙŠ
        $('#searchInput').on('keyup', function() {
            table.search(this.value).draw();
            setTimeout(function() { updateFilterCounter(table); }, 100);
        });
        
        // ÙÙ„ØªØ± Ø³Ø¨Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚
        $('#suspensionFilter').on('change', function() {
            var value = this.value;
            if (value === '') {
                table.column(6).search('').draw();
            } else {
                table.column(6).search(value).draw();
            }
            setTimeout(function() { updateFilterCounter(table); }, 100);
        });
        
        // ÙÙ„ØªØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨
        $('#mandobFilter').on('change', function() {
            var value = this.value;
            if (value === '') {
                table.column(9).search('').draw();
            } else {
                table.column(9).search(value).draw();
            }
            setTimeout(function() { updateFilterCounter(table); }, 100);
        });
        
        // ÙÙ„ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„
        $('#customerFilter').on('change', function() {
            var value = this.value;
            if (value === '') {
                table.column(3).search('').draw();
            } else {
                table.column(3).search(value).draw();
            }
            setTimeout(function() { updateFilterCounter(table); }, 100);
        });
        
        // ÙÙ„ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©
        $('#cityFilter').on('change', function() {
            var value = this.value;
            if (value === '') {
                table.column(8).search('').draw();
            } else {
                table.column(8).search(value).draw();
            }
            setTimeout(function() { updateFilterCounter(table); }, 100);
        });
        
        // ÙÙ„ØªØ± Ø§Ù„Ù…Ø¨Ù„Øº
        $('#amountFilter').on('change', function() {
            var value = this.value;
            
            // Ø¥Ø²Ø§Ù„Ø© ÙÙ„ØªØ± Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø³Ø§Ø¨Ù‚
            $.fn.dataTable.ext.search = $.fn.dataTable.ext.search.filter(function(fn) {
                return fn.name !== 'amountFilter';
            });
            
            if (value !== '') {
                // Ø¥Ø¶Ø§ÙØ© ÙÙ„ØªØ± Ù…Ø¨Ù„Øº Ø¬Ø¯ÙŠØ¯
                var amountFilterFn = function(settings, data, dataIndex) {
                    if (settings.nTable.id !== 'suspendedTable') {
                        return true;
                    }
                    
                    var amountText = data[4]; // Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù…Ø¨Ù„Øº
                    var amount = parseFloat(amountText.replace(/[^\d]/g, ''));
                    
                    switch(value) {
                        case '0-10000':
                            return amount < 10000;
                        case '10000-50000':
                            return amount >= 10000 && amount <= 50000;
                        case '50000-100000':
                            return amount >= 50000 && amount <= 100000;
                        case '100000+':
                            return amount > 100000;
                        default:
                            return true;
                    }
                };
                amountFilterFn.name = 'amountFilter';
                $.fn.dataTable.ext.search.push(amountFilterFn);
            }
            
            table.draw();
            setTimeout(function() { updateFilterCounter(table); }, 100);
        });
        
        // ÙÙ„Ø§ØªØ± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª
        $('#statusInProgress, #statusDelayed, #statusRejected, #statusReturned, #statusDelivered, #statusMandobAccounted').on('change', function() {
            console.log('Status filter changed:', $(this).attr('id'), $(this).is(':checked'));
            applyStatusFilters(table);
        });
        
        // ÙÙ„Ø§ØªØ± Ø§Ø³ØªØ¨Ø¹Ø§Ø¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª
        $('#excludeInProgress, #excludeDelayed, #excludeRejected, #excludeReturned, #excludeDelivered, #excludeMandobAccounted').on('change', function() {
            console.log('Exclude filter changed:', $(this).attr('id'), $(this).is(':checked'));
            applyStatusFilters(table);
        });
    }
    
    // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„Ø§ØªØ± Ø§Ù„Ø­Ø§Ù„Ø§Øª
    function applyStatusFilters(table) {
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
        var includedStatuses = [];
        var excludedStatuses = [];
        
        if ($('#statusInProgress').is(':checked')) includedStatuses.push('Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°');
        if ($('#statusDelayed').is(':checked')) includedStatuses.push('Ù…Ø¤Ø¬Ù„');
        if ($('#statusRejected').is(':checked')) includedStatuses.push('Ø±ÙØ¶');
        if ($('#statusReturned').is(':checked')) includedStatuses.push('Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†');
        if ($('#statusDelivered').is(':checked')) includedStatuses.push('ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…');
        if ($('#statusMandobAccounted').is(':checked')) includedStatuses.push('ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨');
        
        if ($('#excludeInProgress').is(':checked')) excludedStatuses.push('Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°');
        if ($('#excludeDelayed').is(':checked')) excludedStatuses.push('Ù…Ø¤Ø¬Ù„');
        if ($('#excludeRejected').is(':checked')) excludedStatuses.push('Ø±ÙØ¶');
        if ($('#excludeReturned').is(':checked')) excludedStatuses.push('Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†');
        if ($('#excludeDelivered').is(':checked')) excludedStatuses.push('ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…');
        if ($('#excludeMandobAccounted').is(':checked')) excludedStatuses.push('ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨');
        
        console.log('Included statuses:', includedStatuses); // Ù„Ù„ØªØ´Ø®ÙŠØµ
        console.log('Excluded statuses:', excludedStatuses); // Ù„Ù„ØªØ´Ø®ÙŠØµ
        
        // Ø¥Ø²Ø§Ù„Ø© ÙÙ„ØªØ± Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚
        $.fn.dataTable.ext.search = $.fn.dataTable.ext.search.filter(function(fn) {
            return fn.name !== 'statusFilter';
        });
        
        // Ø¥Ø¶Ø§ÙØ© ÙÙ„ØªØ± Ù…Ø®ØµØµ Ù„Ù„Ø­Ø§Ù„Ø§Øª
        if (includedStatuses.length > 0 || excludedStatuses.length > 0) {
            var statusFilterFn = function(settings, data, dataIndex) {
                if (settings.nTable.id !== 'suspendedTable') {
                    return true;
                }
                
                // Ø·Ø±ÙŠÙ‚Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„Ø­Ø§Ù„Ø©
                var statusText = '';
                
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ù…Ù† DOM
                try {
                    var row = $(settings.nTable).find('tbody tr').eq(dataIndex);
                    var statusCell = row.find('td:nth-child(6)'); // Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø­Ø§Ù„Ø© (Ø§Ù„ÙÙ‡Ø±Ø³ 6)
                    statusText = statusCell.find('.badge').text().trim();
                } catch (e) {
                    console.log('DOM method failed, trying data method');
                }
                
                // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©
                if (!statusText) {
                    var status = data[5]; // Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø­Ø§Ù„Ø©
                    if (typeof status === 'string') {
                        if (status.includes('<')) {
                            statusText = $(status).text().trim();
                        } else {
                            statusText = status.trim();
                        }
                    } else {
                        statusText = status.toString().trim();
                    }
                }
                
                console.log('Row', dataIndex, 'Status:', statusText); // Ù„Ù„ØªØ´Ø®ÙŠØµ
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø­Ø§Ù„Ø§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„ØªØ¶Ù…ÙŠÙ†
                if (includedStatuses.length > 0) {
                    if (!includedStatuses.includes(statusText)) {
                        return false;
                    }
                }
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø­Ø§Ù„Ø§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„Ø§Ø³ØªØ¨Ø¹Ø§Ø¯
                if (excludedStatuses.length > 0) {
                    if (excludedStatuses.includes(statusText)) {
                        return false;
                    }
                }
                
                return true;
            };
            statusFilterFn.name = 'statusFilter';
            $.fn.dataTable.ext.search.push(statusFilterFn);
        }
        
        table.draw();
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¨Ø¹Ø¯ Ø§Ù„ÙÙ„ØªØ±Ø©
        setTimeout(function() {
            updateFilterCounter(table);
        }, 100);
    }
    
    // Ø¯Ø§Ù„Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù„Ø­Ø§Ù„Ø§Øª
    function applyCustomStatusColors() {
        $('.badge').each(function() {
            const status = $(this).text().trim();
            $(this).removeClass('bg-success bg-warning bg-danger bg-primary bg-info bg-secondary');
            
            switch(status) {
                case 'ØªÙ… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©':
                    $(this).addClass('status-accounted');
                    break;
                case 'ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨':
                    $(this).addClass('status-mandob-accounted');
                    break;
                case 'ØªÙ… Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„':
                    $(this).addClass('status-customer-accounted');
                    break;
                case 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…':
                    $(this).addClass('status-delivered');
                    break;
                case 'Ø±ÙØ¶':
                    $(this).addClass('status-rejected');
                    break;
                case 'Ø±Ø§Ø¬Ø¹ Ø¬Ø²Ø¦ÙŠ':
                    $(this).addClass('status-partial-return-yellow');
                    break;
                case 'Ù…Ø¤Ø¬Ù„':
                    $(this).addClass('status-delayed');
                    break;
                case 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°':
                    $(this).addClass('status-in-progress');
                    break;
                case 'ØºÙŠØ± Ù…Ø¤ÙƒØ¯':
                    $(this).addClass('status-unconfirmed');
                    break;
                case 'ÙˆØ§ØµÙ„ Ø¬Ø²Ø¦ÙŠ':
                    $(this).addClass('status-partial-delivered');
                    break;
                case 'Ø±Ø§Ø¬Ø¹ Ù…Ø®Ø²Ù†':
                    $(this).addClass('status-warehouse-return');
                    break;
                default:
                    $(this).addClass('status-unconfirmed');
            }
        });
    }
    </script>

    <!-- Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù„ÙˆØ¸Ø§Ø¦Ù -->
    <script>
        function copyOrderInfo(event, waslNumber, customerName, amount, status, phone, city, area, mandobName) {
            const orderInfo = `ğŸ§¾ Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„: ${waslNumber}
ğŸ”´ Ù‡Ø§ØªÙ Ø§Ù„Ø²Ø¨ÙˆÙ†: ${phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
ğŸ¢ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${city || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
ğŸ¢ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${area || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
ğŸ”´ Ø§Ù„Ø³Ø¹Ø±: ${amount}
ğŸ“› Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customerName}
ğŸ“Š Ø§Ù„Ø­Ø§Ù„Ø©: ${status}
ğŸ‘¤ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨: ${mandobName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}`;
            
            navigator.clipboard.writeText(orderInfo).then(function() {
                // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª
                const button = event.target.closest('button');
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check me-1"></i> ØªÙ… Ø§Ù„Ù†Ø³Ø®';
                button.className = 'btn btn-success btn-sm me-1';
                
                setTimeout(function() {
                    button.innerHTML = originalText;
                    button.className = 'btn btn-info btn-sm me-1';
                }, 2000);
            }).catch(function(err) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø³Ø®: ', err);
                alert('Ø®Ø·Ø£ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª');
            });
        }
        
        // Ø¯ÙˆØ§Ù„ Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
        function selectAllStatuses() {
            document.getElementById('statusInProgress').checked = true;
            document.getElementById('statusDelayed').checked = true;
            document.getElementById('statusRejected').checked = true;
            document.getElementById('statusReturned').checked = true;
            document.getElementById('statusDelivered').checked = true;
            document.getElementById('statusMandobAccounted').checked = true;
            
            // Ø¥Ø´Ø§Ø±Ø© Ø¨ØµØ±ÙŠØ©
            showFilterApplied();
            applyStatusFilters($('#suspendedTable').DataTable());
        }
        
        function clearAllStatuses() {
            document.getElementById('statusInProgress').checked = false;
            document.getElementById('statusDelayed').checked = false;
            document.getElementById('statusRejected').checked = false;
            document.getElementById('statusReturned').checked = false;
            document.getElementById('statusDelivered').checked = false;
            document.getElementById('statusMandobAccounted').checked = false;
            
            // Ø¥Ø´Ø§Ø±Ø© Ø¨ØµØ±ÙŠØ©
            showFilterCleared();
            applyStatusFilters($('#suspendedTable').DataTable());
        }
        
        function selectAllExclusions() {
            document.getElementById('excludeInProgress').checked = true;
            document.getElementById('excludeDelayed').checked = true;
            document.getElementById('excludeRejected').checked = true;
            document.getElementById('excludeReturned').checked = true;
            document.getElementById('excludeDelivered').checked = true;
            document.getElementById('excludeMandobAccounted').checked = true;
            applyStatusFilters($('#suspendedTable').DataTable());
        }
        
        function clearAllExclusions() {
            document.getElementById('excludeInProgress').checked = false;
            document.getElementById('excludeDelayed').checked = false;
            document.getElementById('excludeRejected').checked = false;
            document.getElementById('excludeReturned').checked = false;
            document.getElementById('excludeDelivered').checked = false;
            document.getElementById('excludeMandobAccounted').checked = false;
            applyStatusFilters($('#suspendedTable').DataTable());
        }
        
        function clearFilters() {
            var table = $('#suspendedTable').DataTable();
            
            // Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¹Ø§Ù…
            table.search('');
            
            // Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
            table.columns().search('');
            
            // Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø®ØµØµØ©
            $.fn.dataTable.ext.search = [];
            
            // Ù…Ø³Ø­ Ù‚ÙŠÙ… Ø§Ù„Ø­Ù‚ÙˆÙ„
            document.getElementById('searchInput').value = '';
            document.getElementById('suspensionFilter').value = '';
            document.getElementById('amountFilter').value = '';
            document.getElementById('mandobFilter').value = '';
            document.getElementById('customerFilter').value = '';
            document.getElementById('cityFilter').value = '';
            clearAllStatuses();
            clearAllExclusions();
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„
            table.draw();
            setTimeout(function() { updateFilterCounter(table); }, 100);
        }
        
        function exportFilteredData() {
            const table = $('#suspendedTable').DataTable();
            const data = table.rows({ search: 'applied' }).data();
            
            let csv = 'Ø±Ù‚Ù… Ø§Ù„ÙˆØµÙ„,Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨,Ø§Ù„Ø¹Ù…ÙŠÙ„,Ø§Ù„Ù…Ø¨Ù„Øº,Ø§Ù„Ø­Ø§Ù„Ø©,Ø³Ø¨Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©,Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨\n';
            
            data.each(function(row) {
                csv += row.join(',') + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª_Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©_Ø§Ù„Ù…ÙÙ„ØªØ±Ø©.csv';
            link.click();
        }
        
        function printFilteredData() {
            window.print();
        }
        
        function showFilterStats() {
            const table = $('#suspendedTable').DataTable();
            const filteredData = table.rows({ search: 'applied' }).data();
            const totalFiltered = filteredData.length;
            const totalAll = table.rows().count();
            
            alert(`Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙ„ØªØ±Ø©:\nØ§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©: ${totalFiltered}\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: ${totalAll}\nÙ†Ø³Ø¨Ø© Ø§Ù„ÙÙ„ØªØ±Ø©: ${((totalFiltered/totalAll)*100).toFixed(1)}%`);
        }
        
        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©
        function showFilterApplied() {
            // Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø§Ø±Ø© Ø¨ØµØ±ÙŠØ© Ù…Ø¤Ù‚ØªØ©
            const alert = $('<div class="alert alert-success alert-dismissible fade show" role="alert">' +
                           '<i class="fas fa-filter me-2"></i>ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ø¨Ù†Ø¬Ø§Ø­!' +
                           '</div>');
            $('.container-fluid').prepend(alert);
            
            setTimeout(function() {
                alert.fadeOut(500, function() {
                    $(this).remove();
                });
            }, 2000);
        }
        
                 function showFilterCleared() {
             // Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø§Ø±Ø© Ø¨ØµØ±ÙŠØ© Ù…Ø¤Ù‚ØªØ©
             const alert = $('<div class="alert alert-info alert-dismissible fade show" role="alert">' +
                            '<i class="fas fa-times me-2"></i>ØªÙ… Ù…Ø³Ø­ Ø§Ù„ÙÙ„ØªØ±!' +
                            '</div>');
             $('.container-fluid').prepend(alert);
             
             setTimeout(function() {
                 alert.fadeOut(500, function() {
                     $(this).remove();
                 });
             }, 2000);
         }
         
         // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
         function updateFilterCounter(table) {
             const filteredCount = table.rows({ search: 'applied' }).count();
             const totalCount = table.rows().count();
             
             // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
             const cardTitle = $('.card-title');
             cardTitle.html(`<i class="fas fa-clock me-2"></i>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© - ${filteredCount} Ù…Ù† ${totalCount} Ø·Ù„Ø¨`);
             
             // Ø¥Ø¶Ø§ÙØ© Ù„ÙˆÙ† Ù…Ø®ØªÙ„Ù Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ÙÙ„ØªØ±
             if (filteredCount < totalCount) {
                 cardTitle.addClass('text-primary');
                 // Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø© ÙÙ„ØªØ±
                 if (!cardTitle.find('.filter-icon').length) {
                     cardTitle.append(' <i class="fas fa-filter filter-icon text-success"></i>');
                 }
             } else {
                 cardTitle.removeClass('text-primary');
                 // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ÙÙ„ØªØ±
                 cardTitle.find('.filter-icon').remove();
             }
         }
    </script>
</body>
</html> 